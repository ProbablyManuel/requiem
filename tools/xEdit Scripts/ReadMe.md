Installation
============

It just works
-------------

Copy all files in this folder to the folder `Edit Scripts` of your xEdit installation.

Advanced
--------

See [link_scripts.py](#link_scriptspy).



xEdit Scripts
=============

REQ_AddItemsToLeveledList.pas
-----------------------------

Add the selected items to a new or existing leveled item.

The script prompts the user to enter the EditorID of the new leveled item or the $-prefixed FormID of the existing item (e.g. `$0842E2A8`). The leveled item is created in the file of the first selected item.

REQ_AddItemsToOutfit.pas
------------------------

Create a new outfit and add the selected items to it.

The script prompts the user to enter the EditorID of the new outfit. The outfit is created in the file of the first selected item.

REQ_AddNpcsToLeveledList.pas
----------------------------

Add the selected NPCs to a new or existing leveled NPC.

The script prompts the user to enter the EditorID of the new leveled NPC or the $-prefixed FormID of the existing NPC (e.g. `$0842E2A8`). The leveled NPC is created in the file of the first selected item.

REQ_ArmorPatcher.pas
--------------------

Set armor rating, weight, and price of the selected armors based on `REQ_ArmorPatcher.txt`.

`REQ_ArmorPatcher.txt` maps armor identifiers of the form `<type>_<set>_<slot>` or `Artifact_<name>` to a triplet of armor rating, weight, and price. Armors are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records). The identifier is automatically extracted from an armor's full EditorID which may include any mod prefix (not just "REQ"), the "Ench", "Var", or "NP" modifier, and any suffix. Values in the triplet should be exactly as displayed in xEdit's GUI. Additionally, identifiers may be specialized with a suffix, e.g. `Light_Imperial_Body_Studded`, in which case the values from the more specialized identifier are used.

`REQ_ArmorPatcher.txt` is generated by [armor_patcher.py](#armor_patcherpy) and should not be edited by hand.

REQ_CapLockLevel.pas
------------------------

Copy references of the selected containers into a plugin and cap their lock level.

The script prompts the user to enter the name of the target plugin. If the plugin does not exist, it will be created. Then, the script prompts the user to enter the lock level as an integer.

REQ_CopyMagicEffects.pas
------------------------

Copy magic effects from the selected spells into a plugin.

The script prompts the user to enter the name of the target plugin. If the plugin does not exist, it will be created.

REQ_CopyReferencedBy.pas
------------------------

Copy records that reference the selected records into a plugin.

The script prompts the user to enter the name of the target plugin. If the plugin does not exist, it will be created.

REQ_CreateTemperedItem.pas
--------------------------

Create tempered items for the selected armors and weapons.

The script prompts the user to enter the minimum and maximum item condition (as an integer percentage). Then, it generates for each selected armor and weapon a leveled item that is populated with all possible item condition values in the given range. The armors and weapons must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records) of a standard armor or weapon. The recipes are created in the same file as the selected items.

REQ_CreateTemperingRecipe.pas
-----------------------------

Create tempering recipes for the selected armors and weapons.

The recipes are created in the same file as the selected items. The created recipes do not have an EditorID or ingredients and conditions. Use [REQ_NameRecipe.pas](#REQ_NameRecipepas) and [REQ_RecipePatcher.pas](#REQ_RecipePatcherpas) to generate them.

REQ_ExportArtifactDescriptions.pas
----------------------------------

Export enchantment descriptions of the selected armors and weapons to a csv file.

The comma-separated values are EditorId,slot,name,description. The description field is a semicolon-separated list of all enchantment effects, including equip abilities and spells applied by scripts. If the enchantment contains the visible effects, the description on the item is used instead. "\<mag\>" and "\<dur\>" are substituted by the actual numbers while retaining the tag (e.g. "\<12\>").


REQ_ExportForms.pas
-------------------

Export the EditorID and full name of the selected forms to two csv files.

The comma-separated values are EditorID,formid and name,formid respectively. Formids are represented in the form `Skyrim.esm:034CDD`. All versions of a record are exported, i.e., if the EditorID/name of a record is changed by an overriding plugin, both the old and new version are exported for this record.

REQ_ExportIngredients.pas
-------------------------

Export the effects of the selected ingredient to a csv file.

The comma-separated values are race,health,magicka,stamina,carry_weight,unarmed_damage,magicka_rate,stamina_rate,blood,physique,heritage,power,unperked,skill and the lines are lexicographically sorted.

REQ_ExportRaceDescriptions.pas
-----------------------

Export the stats and abilities of the selected race to a csv file.

The comma-separated values are effect,magnitude,duration,ingredient and the lines are lexicographically sorted.

REQ_ExportSpellScaling.pas
-------------------------

Export magnitude/duration scaling data of the selected spell effects to a csv file.

The first line is a header with the column names and the remaining comma-separated values are unsorted. Spell effects are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#magic-effect-mgef-records).

REQ_FilterActorValue.pas
------------------------

Apply a filter to show all records referencing a given actor value. This covers hardcoded references such perk entry functions or condition parameters.

The script prompts the user to enter an actor value.

REQ_FilterNoCharges.pas
-----------------------

Apply a filter to show all weapons with an enchantment but no charges.

REQ_GravityPullPatcher.pas
--------------------------

Set the gravity of the selected ammo projectiles based on the ammo weight keyword of the referencing ammo.

The EditorID of the ammo must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#ammunition-ammo-records). The ammo may have an arbitrary mod prefix (not just "REQ").

REQ_LeveledItemPatcher.pas
--------------------------

Set content of the selected leveled items based on `REQ_LeveledItemPatcher.txt`.

`REQ_LeveledItemPatcher.txt` maps leveled list identifiers to triplets of level, reference, and count. Leveled lists are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#leveled-item-lvli-records). The identifier is automatically extracted from a leveled list's full EditorID which may include any mod prefix (not just "REQ"). Values in the triplet should be exactly as displayed in xEdit's GUI with the exception of formids which must be of the form `Skyrim.esm:034CDD`.

REQ_ListArmorVariants.pas
-------------------------

List all armor variants among the select armors.

Armors are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records). An armor variant is defined as an armor whose EditorID is specialized with a suffix, e.g. `Light_Imperial_Body_Studded`.

REQ_Name1stPersonWeapon.pas
---------------------------

Set the EditorID of the selected 1st person weapon models based on the referencing weapon.

The referencing weapon must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#weapon-weap-records).

REQ_NameAfterFullName.pas
-------------------------

Set the EditorID of the selected records based on their full names.

The script prompts the user to enter a prefix that will be prepended to all EditorIDs. Then, the name (subrecord 'FULL - Names') is processed by concatenating all words in upper camel case and removing apostrophes and hyphens. For example, choosing the prefix "REQ\_Artifact\_" for "Gadnor's Staff of Charming" results in the EditorID `REQ_Artifact_GadnorsStaffOfCharming`.

REQ_NameArmor.pas
-----------------

Set the EditorID of the selected armors based on their type, material/set, and equip slot.

The script prompts the user to enter the name of the armor set. Then, the EditorID is assembled so that it adheres to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records).

REQ_NameEnchantedWeapon.pas
---------------------------

Set the EditorID of the selected enchanted weapons based on the weapon and enchantment.

The EditorID of the template weapon and enchantment must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention). The template weapon and enchantment may have an arbitrary mod prefix (not just "REQ"), but the mod prefix of the enchanted weapon cannot be chosen and is defined by the template weapon.

At the end, the user is given the option to save all generated EditorIDs in a file, which can be used to provide an overview over all enchanted variants.

REQ_NameMagicEffect.pas
-----------------------

Set the EditorID of the selected magic effects based on the referencing spells.

The EditorID of the spells must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#spells-spel-records). The spells may have an arbitrary mod prefix (not just "REQ").

REQ_NameProjectile.pas
----------------------

Set the EditorID and name of the selected ammo projectiles based on the referencing ammo.

The EditorID of the ammo must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#ammunition-ammo-records). The ammo may have an arbitrary mod prefix (not just "REQ").

REQ_NameRecipe.pas
------------------

Set the EditorID of the selected constructible objects based on the workbench and item.

The script prompts the user to enter a prefix that will be prepended to all EditorIDs. Then, the EditorID is constructed as required by the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#constructible-objects-cobj-records). The EditorID of the item is taken ad verbatim and therefore it is a soft requirement that all items already have a proper EditorID.

REQ_RecipePatcher.pas
---------------------

Set ingredients and conditions of the selected recipes based on `REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt`.

`REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt` map recipe identifiers of the form `<workbench>_<item>` to pairs of formid and count and to sextuplets of comparison operator, comparison value, condition function, parameter 1, parameter 2, and function target. Recipes are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#constructible-objects-cobj-records). The identifier is automatically extracted from a recipe's full EditorID which may include any mod prefix (not just "REQ") and the Var modifier. Values in the pair and sextuplet should be exactly as displayed in xEdit's GUI with the exception of formids which must be of the form `Skyrim.esm:034CDD`.

`REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt` are generated by [recipe_patcher.py](#recipe_patcherpy) and should not be edited by hand.

REQ_SetPersistentLocation.pas
-----------------------------

Set a persistent location for the selected actors and copy the respective locations into the plugin.

The plugin needs to be saved in the Creation Kit afterwards to update the location records.

REQ_SpellScalingPatcher.pas
---------------------------

Set magnitude/duration scaling of the selected spells and spell effects based on `REQ_SpellScaling.txt.txt`

`REQ_SpellScaling.txt` maps spell identifiers of the form `<skill><tier>_<name>` to septuples of Power Affects Magnitude, Power Affects Duration, No Magnitude, No Duration, No Magnitude Scaling, No Duration Scaling, and No Dual Cast Modification. Spells and magic effects are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#magic-effect-mgef-records). The identifier is automatically extracted from a spell's or magic effect's full EditorID which may include any mod prefix (not just "REQ").

`REQ_SpellScaling.txt` is generated by [spell_scaling.py](#spell_scalingpy) and should not be edited by hand.

REQ_WeaponPatcher.pas
---------------------

Set damage, weight, price, speed, reach, and stagger of the selected melee weapon based on `REQ_WeaponPatcher.txt`.

`REQ_WeaponPatcher.txt` maps weapon identifiers of the form `Weapon_<set>_<type>` or `Artifact_<name>` to a sextuplet of damage, weight, price, speed, reach, and stagger. Weapons are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#weapon-weap-records). The identifier is automatically extracted from an weapon's full EditorID which may include any mod prefix (not just "REQ"), the "Ench", "Var", or "NP" modifier, and any suffix. Values in the sextuplet should be exactly as displayed in xEdit's GUI.

`REQ_WeaponPatcher.txt` is generated by [weapon_patcher.py](#weapon_patcherpy) and should not be edited by hand.



Python Scripts
==============

The scripts reading from Excel files may require running `pip install pandas openpyxl` first.

armor_patcher.py
----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](patcher_data#armor).

artifacts_description.py
------------------------

Generates `Artifacts.md` based on the data in [ArtifactDescriptions.txt](export/ArtifactDescriptions.txt).

document_races.py
------------------------

Generates `Races.md` based on the data in [ArtifactDescriptions.txt](export/ArtifactDescriptions.txt).

leveled_item_patcher.py
-----------------------

Generates `REQ_LeveledItemPatcher.txt` based on the data in [leveled_armor.json](patcher_data#leveled_armor) and [leveled_weapon.json](patcher_data#leveled_weapon). Available armor parts and weapon types are read from [Armor.xlsx](patcher_data#armor) and [Weapon.xlsx](patcher_data#weapon).

link_scripts.py
---------------

Creates a hard link for every file in this directory starting with "REQ_" to xEdit so that the files are simultaneously under version control in this git repository and available to xEdit.

If xEdit is installed in a location other than `C:\Skyrim Tools\SSEEdit`, the script should be invoked by dragging the folder containing `SSEEdit.exe` onto it.

recipe_patcher.py
-----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](patcher_data#armor) and [Weapon.xlsx](patcher_data#weapon).

The script can be invoked by dragging two custom text files onto it to provide easy integration of third-party armors and weapons. The files should be equal to the ones used to extend the armor and weapon patcher.

spell_scaling_raw.py
--------------------

Sanitizes the csv file generated by `REQ_ExportSpellScaling.pas`.

spell_scaling.py
----------------

Generates `REQ_SpellScaling.txt` based on the data in [SpellScaling.xlsx](patcher_data#spellscaling).

strict_dict.py
--------------

Implements a dictionary that raises an exception when assigning a value to an existing key.

weapon_patcher.py
-----------------

Generates `REQ_WeaponPatcher.txt` based on the data in [Weapon.xlsx](patcher_data#weapon).
